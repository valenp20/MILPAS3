<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,100..900;1,100..900&family=Instrument+Serif&family=Libre+Baskerville:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <title>Mi P√°gina</title>
   
    <link rel="stylesheet" href="docs/estilos.css?v=6.0"> 
    <style>
    /* Forzar +10px al logo en m√≥viles (index.html usa docs/logo.png 250x200) */
    @media (max-width: 600px) {
        .logo img { width: 260px !important; height: 210px !important; max-width: none !important; }
    }
    @media (max-width: 433px) {
        .logo img { width: 260px !important; height: 210px !important; max-width: none !important; }
    }
    </style>
</head>
<body>

   
    
    <header class="main-header">
        <div class="header-main">
            <div class="logo">
                <a href="#"><img src="docs/logo.png" width="250" height="200" alt="Logo"></a>
            </div>
           
            <div class="search-bar">
                <input type="text" placeholder="Busca productos">
                <button type="submit">üîç</button>
            </div>
           
    </header>

    <nav class="main-nav">
        <button class="nav-toggle" id="nav-toggle" aria-controls="nav-links" aria-expanded="false">‚ò∞</button>
        <ul class="nav-links" id="nav-links">
            <li><a href="#" data-category="Home">INICIO</a></li>
            <li><a href="#about" data-category="About">QUIENES SOMOS</a></li>
            <li class="products-parent">
                <a href="#" id="products-link">NUESTROS PRODUCTOS ‚ñæ</a>
                <ul class="products-submenu" aria-hidden="true">
                     <li><a href="#" data-category="L√°cteos">LACTEOS</a></li>
                    <li><a href="#" data-category="Frutos Secos">FRUTOS SECOS</a></li>
                    <li><a href="#" data-category="Panaderia">PANADERIA</a></li>
                    <li><a href="#" data-category="Limpieza">LIMPIEZA</a></li>
                    <li><a href="#" data-category="Hogar">HOGAR</a></li>
                    <li><a href="#" data-category="Dulces y postres">DULCES Y POSTRES</a></li>
                <li><a href="#" data-category="Aseo personal">ASEO PERSONAL</a></li>
                <li><a href="#" data-category="Aceites y untables">ACEITES Y UNTABLES</a></li>
                <li><a href="#" data-category="Bebidas">BEBIDAS</a></li>
                <li><a href="#" data-category="Condimentos">CONDIMENTOS</a></li>
                <li><a href="#" data-category="Enlatados">ENLATADOS</a></li>
               <li><a href="#" data-category="Granos y cereales">GRANOS Y CEREALES</a></li>
                </ul>
            </li>
            <li><a href="#contacto" data-category="Contact">CONTACTANOS</a></li>
        </ul>
    </nav>

    
    <!-- Secci√≥n Hero Mejorada -->
    <section class="hero-wrapper">
        <section class="hero">
            <picture>
                <source type="image/webp" srcset="fondo-480.webp 480w, fondo-768.webp 768w, fondo-1024.webp 1024w, fondo-1440.webp 1440w, fondo-1920.webp 1920w" sizes="100vw">
                <img class="hero-img" src="docs/hero1.png" srcset="docs/fondo-480.jfif 480w, docs/fondo-768.jfif 768w, docs/fondo-1024.jfif 1024w, docs/fondo-1440.jfif 1440w, docs/fondo-1920.jfif 1920w" sizes="100vw" alt="" aria-hidden="true" loading="eager" decoding="async">
            </picture>
            
            <div class="hero-overlay"></div>
            
            <div class="hero-inner">
                <div class="hero-badge">
                    <span class="badge-icon">üåø</span>
                    <span class="badge-text">Desde 1969</span>
                </div>
                
                <h1 class="hero-title">
                    <span class="hero-title-line1">VEGETALES</span>
                    <span class="hero-title-line2">SIEMPRE FRESCOS</span>
                </h1>
                
                <p class="hero-subtitle">Tenemos el mejor surtido de vegetales frescos para usted</p>
                
                <div class="hero-cta">
                    <button class="btn-primary" onclick="document.getElementById('products-link').click()">
                        Ver Productos
                        <span class="btn-arrow">‚Üí</span>
                    </button>
                    <button class="btn-secondary" onclick="document.getElementById('about').scrollIntoView({behavior:'smooth'})">
                        Nuestra Historia
                    </button>
                </div>
                
                <div class="hero-features">
                    <div class="feature-item">
                        <span class="feature-icon">‚úì</span>
                        <span class="feature-text">Productos Frescos</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚úì</span>
                        <span class="feature-text">Mejores Precios</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">‚úì</span>
                        <span class="feature-text">Calidad Garantizada</span>
                    </div>
                </div>
            </div>
            
            <div class="hero-scroll-indicator">
                <span class="scroll-arrow">‚Üì</span>
            </div>
        </section>
    </section>

  
    <aside id="side-panel" class="side-panel" aria-hidden="true">
        <div class="side-header">
            <button id="side-close" class="side-close" aria-label="Cerrar">‚úï</button>
            <h3>Categor√≠as</h3>
        </div>
        <nav id="side-nav" class="side-nav" aria-label="Navegaci√≥n de categor√≠as">
           
        </nav>
    </aside>
    <div id="side-overlay" class="side-overlay" aria-hidden="true"></div>

    <main>
      
        

       
        

       
        <h2 id="category-title" style="display:none; text-align:center; margin-top:18px;"> </h2>

        <div class="product-carousel" id="product-carousel">
            
        </div>

        
        <section id="about" class="contact-section" style="margin:20px;">
            
            <img src="docs/historia.png" alt="Historia Supermercado Las Cuatro Milpas" class="about-image">
            <div class="about-text">
                <p>El Supermercado Las Cuatro Milpas, tiene sus or√≠genes a mediados de noviembre de 1969, cuando el se√±or Edilberto Pineda y Otoniel Valencia Londo√±o deciden establecer una tienda peque√±a en el municipio de Chinchin√°. As√≠, los nuevos empresarios realizaron un negocio con el se√±or Efra√≠n Mej√≠a, propietario del local en el cual funcionaba una cantina llamada Las Cuatro Milpas, ubicada cerca de la estaci√≥n de bomberos y de la zona de tolerancia del municipio, sector muy comercial en esa √©poca; all√≠ decidieron instalarse.</p>

                <p>Con el fin de iniciar labores comerciales don Otoniel invita a su hijo Samuel Valencia para que trabaje con √©l. El negocio basaba su oferta en petr√≥leo, carb√≥n y abarrotes en general, muy demandados en ese tiempo por la comunidad, pero debido al cambio de actividad (de cantina a tienda) el negocio no ofreci√≥ los resultados esperados; por ello don Edilberto Pineda decidi√≥ retirarse y propuso a don Samuel que trabajara con √©l. Don Samuel acept√≥ la propuesta, aunque aclar√≥ que s√≥lo lo har√≠a hasta que su padre don Otoniel encontrara d√≥nde ubicarse.</p>

                <p>Pasados algunos a√±os, cuando el negocio ya funcionaba mejor, comenzaron a tener problemas por falta de espacio para bodega y por incrementos en el arriendo del local, lo que motiv√≥ la compra de una casa en proceso de sucesi√≥n en 1976. Despu√©s de adquirir el predio, establecieron la tienda all√≠ por dos a√±os, conservando el nombre original y realizando actividades comerciales al detal (menudeo). Debido a la estrechez de la casa y al crecimiento del negocio, que obligaba a utilizar habitaciones como bodega, decidieron trasladarse a la Cra 6 N¬∫ 7-07, a un local m√°s amplio que les permiti√≥ construir bodegas con mayor capacidad de almacenamiento.</p>

                <p>Cinco a√±os m√°s tarde se adquiri√≥ un predio junto al local y se anex√≥ al negocio, buscando aumentar el comercio al mayoreo combin√°ndolo con el menudeo, hasta lograr una mezcla surtiendo tiendas y vendiendo mercados para finca y hogares. Esto oblig√≥ una reestructuraci√≥n para independizar las dos funciones: don Otoniel con do√±a Rosa Valencia se encargaron del menudeo y don Samuel del mayoreo.</p>

                <p>Por ese tiempo do√±a Rosa se cas√≥ con el se√±or Bernardo Castro, quien ingres√≥ a hacer parte del negocio al menudeo. Don Samuel ten√≠a la idea de montar un supermercado y, tras meditarlo, decidi√≥ comprar un lote y construir un local, al cual se le adecuaron g√≥ndolas de metal para iniciar el supermercado. En 1985 construy√≥ el SUPERMERCADO LAS CUATRO MILPAS, trasladando parte de la venta al menudeo que ten√≠a en el Granero. Se conform√≥ as√≠ una sociedad de hecho entre los fundadores: don Otoniel Valencia, don Samuel Valencia, do√±a Rosa Valencia y don Bernardo Castro.</p>

                <p>Don Samuel se retir√≥ por un tiempo para dedicarse a otros negocios, pero con la muerte de don Otoniel regres√≥ y qued√≥ como socio junto a do√±a Rosa y don Bernardo. En 1988 se realiz√≥ una negociaci√≥n con la se√±ora Luz Marina Duque para encargarse de la parte del menudeo con los otros socios, permitiendo que don Samuel se dedicara al mayoreo; esa sociedad termin√≥ dos a√±os despu√©s, y don Samuel reasumi√≥ ambas funciones.</p>

                <p>Do√±a Luz Marina propuso abrir un supermercado en Armenia, form√°ndose una sociedad entre don Samuel, do√±a Luz Marina y el Supermercado Las Cuatro Milpas N¬∞1 de Chinchin√°, autoriz√°ndose el uso de la misma raz√≥n social. En 1994 se compr√≥ un local en Armenia y all√≠ se cambi√≥ la ubicaci√≥n del supermercado.</p>

                <p>En 1995 se inici√≥ un proceso de reestructuraci√≥n: el granero (mayoreo) dej√≥ de vender mercados (menudeo) y traslad√≥ esa funci√≥n al supermercado; en el mismo a√±o se inici√≥ la sistematizaci√≥n (software) de operaciones con el fin de mejorar el flujo de informaci√≥n administrativa. Para el a√±o 2000 se decidi√≥ fusionar todos los negocios bajo un mismo NIT y se cre√≥ un proceso de auditor√≠a interna, cambios que afectaron la contabilidad y generaron controles que incidieron en la cultura organizacional, provocando la independencia del supermercado de Armenia, que qued√≥ a cargo de do√±a Luz Marina Duque.</p>

                <p>Tiempo despu√©s, don Bernardo Castro decidi√≥ emprender su propio negocio y se retir√≥, quedando en agosto de 2004 solo dos socios en el Supermercado Las Cuatro Milpas N¬∞1: do√±a Rosa y don Samuel Valencia. Pasados unos meses do√±a Rosa se retir√≥ para acompa√±ar a su esposo en la construcci√≥n de su nuevo negocio; en ese a√±o don Samuel constituy√≥ la empresa CUATRO MILPAS S.A., incorporando a su esposa e hijas, quienes continuaron con el reto de hacer de la empresa una organizaci√≥n pr√≥spera y humana, contribuyendo al desarrollo del municipio y ofreciendo a sus clientes los mejores productos y precios.</p>

                
            </div>
        </section>

        
        <section id="contacto" class="contact-section-modern">
            <div class="contact-container">
                <h2 class="contact-title">Cont√°ctanos</h2>
                <p class="contact-subtitle">Estamos aqu√≠ para atenderte</p>
                
                <div class="contact-grid">
                    <!-- Tarjeta de Tel√©fono -->
                    <div class="contact-card">
                        <div class="contact-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                <path d="M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.568 17.568 0 0 0 4.168 6.608 17.569 17.569 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.678.678 0 0 0-.58-.122l-2.19.547a1.745 1.745 0 0 1-1.657-.459L5.482 8.062a1.745 1.745 0 0 1-.46-1.657l.548-2.19a.678.678 0 0 0-.122-.58L3.654 1.328zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.678.678 0 0 0 .178.643l2.457 2.457a.678.678 0 0 0 .644.178l2.189-.547a1.745 1.745 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.634 18.634 0 0 1-7.01-4.42 18.634 18.634 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877L1.885.511z"/>
                            </svg>
                        </div>
                        <h3 class="contact-card-title">Tel√©fono</h3>
                        <p class="contact-card-info">+57 606 8404850</p>
                        <a href="tel:+576068404850" class="contact-btn" aria-label="Llamar al Supermercado Las Cuatro Milpas">
                            Llamar ahora
                        </a>
                    </div>

                    <!-- Tarjeta de Email -->
                    <div class="contact-card">
                        <div class="contact-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
                            </svg>
                        </div>
                        <h3 class="contact-card-title">Email</h3>
                        <p class="contact-card-info">asistentecuatromilpas@gmail.com</p>
                        <a href="mailto:asistentecuatromilpas@gmail.com" class="contact-btn" aria-label="Enviar email al Supermercado Las Cuatro Milpas">
                            Enviar email
                        </a>
                    </div>

                    <!-- Tarjeta de Nuestras Sedes -->
                    <div class="contact-card contact-card-locations">
                        <div class="contact-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 16 16">
                                <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/>
                            </svg>
                        </div>
                        <h3 class="contact-card-title">Nuestras Sedes</h3>
                        
                        <div class="locations-list">
                            <div class="location-item">
                                <h4 class="location-name">Cuatro Milpas Galer√≠a</h4>
                                <p class="location-address">Carrera 6 # 7 - 12, Chinchin√°, Caldas</p>
                                <p class="location-phone">Tel: 840 4850</p>
                            </div>
                            
                            <div class="location-item">
                                <h4 class="location-name">Cuatro Milpas Estaci√≥n</h4>
                                <p class="location-address">Calle 13 # 5 - 80, Chinchin√°, Caldas</p>
                                <p class="location-phone">Tel: 313 745 3149</p>
                            </div>
                            
                            <div class="location-item">
                                <h4 class="location-name">Cuatro Milpas Express Divino Ni√±o</h4>
                                <p class="location-address">Carrera 14 # 5a - 02, Chinchin√°, Caldas</p>
                            </div>
                        </div>
                        
                        <a href="https://www.google.com/maps/search/?api=1&query=Supermercado+Cuatro+Milpas+Chinchin√°+Caldas+Colombia" target="_blank" rel="noopener noreferrer" class="contact-btn" aria-label="Ver ubicaciones en Google Maps">
                            Ver en mapa
                        </a>
                    </div>
                </div>

                <!-- Secci√≥n de Redes Sociales Mejorada -->
                <div class="contact-social-modern">
                    <h3 class="social-title">S√≠guenos en nuestras redes</h3>
                    <div class="social-icons-modern">
                        <a href="https://www.facebook.com/supermercadocuatromilpas?locale=es_LA" target="_blank" rel="noopener noreferrer" aria-label="Facebook ‚Äî Supermercado Las Cuatro Milpas" class="social-link-modern social-facebook">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white" aria-hidden="true" focusable="false">
                                <path d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 4.99 3.66 9.13 8.44 9.93v-7.03H8.07v-2.9h2.37V9.41c0-2.35 1.4-3.64 3.53-3.64 1.02 0 2.09.18 2.09.18v2.3h-1.18c-1.16 0-1.52.72-1.52 1.46v1.76h2.59l-.41 2.9h-2.18v7.03C18.34 21.2 22 17.06 22 12.07z"/>
                            </svg>
                        </a>
                        <a href="https://www.instagram.com/supermercadoscuatromilpas/?hl=es" target="_blank" rel="noopener noreferrer" aria-label="Instagram ‚Äî Supermercado Las Cuatro Milpas" class="social-link-modern social-instagram">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
                                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect>
                                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                                <line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line>
                            </svg>
                        </a>
                        <a href="https://whatsapp.com/channel/0029VbB56bS3WHTUrzfdi92K" target="_blank" rel="noopener noreferrer" aria-label="Comunidad de WhatsApp ‚Äî Supermercado Las Cuatro Milpas" class="social-link-modern social-whatsapp">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="white" viewBox="0 0 16 16" aria-hidden="true" focusable="false">
                                <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.24-.59-.48-.51-.66-.51-.17 0-.37-.02-.57-.02-.2 0-.52.07-.79.37-.27.3-1.03 1-1.03 2.43s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
                            </svg>
                        </a>
                        <a href="https://wa.me/576068404850" target="_blank" rel="noopener noreferrer" aria-label="Contactar por WhatsApp ‚Äî Supermercado Las Cuatro Milpas" class="contact-btn contact-btn-whatsapp">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="white" viewBox="0 0 16 16" style="margin-right: 8px;">
                                <path d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.24-.59-.48-.51-.66-.51-.17 0-.37-.02-.57-.02-.2 0-.52.07-.79.37-.27.3-1.03 1-1.03 2.43s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"/>
                            </svg>
                            Chatea con nosotros
                        </a>
                    </div>
                </div>
            </div>
        </section>

        
        <section id="metodos" class="contact-section" style="margin:20px; display:none;">
            <h3>Medios de pago</h3>
            <p>Aceptamos: Efectivo, tarjetas d√©bito/cr√©dito, transferencias y pago m√≥vil.</p>
            <p>Pr√≥ximamente agregaremos m√°s detalles sobre cuotas y promociones.</p>
        </section>

    </main>

    <footer class="main-footer">
        <div class="footer-links">
            <div></div>
        </div>
        <div class="footer-copy" id="footer-copy" aria-live="polite"></div>
    </footer>

       
        

    <script>
        async function loadProducts() {
            try {
                const res = await fetch('/api/products');
                if (!res.ok) throw new Error('Error al obtener productos');
                const products = await res.json();
                const container = document.getElementById('product-carousel');
                container.innerHTML = '';
                
                products.forEach(p => {
                    const div = document.createElement('div');
                    div.className = 'producto';

                    const img = document.createElement('img');
                    img.src = p.image;
                    img.alt = p.name;
                    img.width = 50;
                    img.height = 50;

                    const h3 = document.createElement('h3');
                    h3.textContent = String(p.name).replace(/\s*&\s*/g, ' y ');

                    div.appendChild(img);
                    div.appendChild(h3);

                        container.appendChild(div);
                });
            } catch (err) {
                console.error(err);
                const container = document.getElementById('product-carousel');
                container.innerHTML = '';
            }
        }

        // document.addEventListener('DOMContentLoaded', loadProducts);
    </script>
    <script>
        (function(){
            const prodLink = document.getElementById('products-link');
            const prodSub = document.querySelector('.products-submenu');
            if (!prodLink || !prodSub) return;

            prodLink.addEventListener('click', (e)=>{
                e.preventDefault();
                const open = prodSub.classList.toggle('open');
                prodSub.setAttribute('aria-hidden', String(!open));
            });

            document.addEventListener('click', (ev)=>{
                if (!prodSub.contains(ev.target) && ev.target !== prodLink) {
                    prodSub.classList.remove('open');
                    prodSub.setAttribute('aria-hidden','true');
                }
            });

            const subLinks = prodSub.querySelectorAll('a[data-category]');
            subLinks.forEach(s=>{
                s.addEventListener('click', ()=>{
                    prodSub.classList.remove('open'); prodSub.setAttribute('aria-hidden','true');
                    const navLinks = document.getElementById('nav-links');
                    if (navLinks && navLinks.classList.contains('open')) navLinks.classList.remove('open');
                });
            });
        })();
    </script>

    
    <script>
        (function(){
            const footer = document.querySelector('.main-footer');
            if (!footer) return;
            let lastY = window.pageYOffset || 0;
            let rafScheduled = false;

            function onScroll(){
                if (rafScheduled) return;
                rafScheduled = true;
                window.requestAnimationFrame(()=>{
                    const y = window.pageYOffset || 0;
                    if (y > lastY + 10) {
                        footer.classList.add('footer-hidden');
                    } else if (y < lastY - 10) {
                        footer.classList.remove('footer-hidden');
                    }
                    lastY = y;
                    rafScheduled = false;
                });
            }

            window.addEventListener('scroll', onScroll, { passive: true });
        })();
    </script>

        <script>

            (function(){
                    const container = document.getElementById('product-carousel');
                    const nav = document.getElementById('nav-links');
                    let allProducts = [];

                    function showProducts(){
                        if (container) container.style.display = '';
                        const titleEl = document.getElementById('category-title');
                        if (titleEl && titleEl.textContent && titleEl.textContent.trim()) titleEl.style.display = '';
                    }
                    function hideProducts(){
                        if (container) container.style.display = 'none';
                        const titleEl = document.getElementById('category-title');
                        if (titleEl) titleEl.style.display = 'none';
                    }

                    function initSearchBar() {
                        const searchInput = document.querySelector('.search-bar input');
                        const searchButton = document.querySelector('.search-bar button');
                        let searchTimeout = null;
                        
                        if (!searchInput || !searchButton) return;
                        
                        function performSearch() {
                            const searchTerm = searchInput.value.trim().toLowerCase();
                            const titleEl = document.getElementById('category-title');
                            
                            if (!searchTerm) {
                                renderProducts(allProducts);
                                if (titleEl) {
                                    titleEl.style.display = 'none';
                                }
                                showProducts();
                                return;
                            }
                            
                            const filtered = allProducts.filter(p => {
                                const name = String(p.name || '').toLowerCase();
                                const category = String(p.category || '').toLowerCase();
                                const description = String(p.description || '').toLowerCase();
                                
                                return name.includes(searchTerm) || 
                                       category.includes(searchTerm) || 
                                       description.includes(searchTerm);
                            });
                            
                            if (titleEl) {
                                if (filtered.length > 0) {
                                    titleEl.textContent = `RESULTADOS DE B√öSQUEDA: "${searchInput.value.trim()}" (${filtered.length})`;
                                    titleEl.style.display = 'block';
                                } else {
                                    titleEl.textContent = `NO SE ENCONTRARON RESULTADOS PARA: "${searchInput.value.trim()}"`;
                                    titleEl.style.display = 'block';
                                }
                            }
                            
                            hideInfoSections();
                            renderProducts(filtered);
                            showProducts();
                        }
                        
                        searchButton.addEventListener('click', (e) => {
                            e.preventDefault();
                            performSearch();
                        });
                        
                        searchInput.addEventListener('keypress', (e) => {
                            if (e.key === 'Enter') {
                                e.preventDefault();
                                performSearch();
                            }
                        });
                        
                        searchInput.addEventListener('input', () => {
                            clearTimeout(searchTimeout);
                            searchTimeout = setTimeout(() => {
                                performSearch();
                            }, 500);
                        });
                    }
               
                function renderProducts(products){
                   
                    const isHome = (window.isHomeMode === undefined) ? true : !!window.isHomeMode;
                    const list = isHome ? (products || []).filter(p => !p.discount || Number(p.discount) <= 0) : (products || []);
                    container.innerHTML = '';
                    if (!list || list.length === 0) {
                        
                        container.innerHTML = '';
                        return;
                    }
                    list.forEach(p => {
                        const div = document.createElement('div');
                        div.className = 'producto';

                        const img = document.createElement('img');
                        img.src = p.image || '';
                        img.alt = p.name || '';
                        img.width = 50;
                        img.height = 50;

                        const h3 = document.createElement('h3');
                        h3.textContent = String(p.name).replace(/\s*&\s*/g, ' y ');

                        div.appendChild(img);
                        div.appendChild(h3);

                        // Agregar evento click para mostrar detalles en modal
                        div.addEventListener('click', () => {
                            document.getElementById('modal-title').textContent = p.name;
                            document.getElementById('modal-image').src = p.image;
                            document.getElementById('modal-image').alt = p.name;
                            document.getElementById('modal-category').textContent = `Categor√≠a: ${p.category}`;
                            document.getElementById('modal-description').textContent = p.description || 'Sin descripci√≥n';
                            document.getElementById('modal-price').textContent = `Precio: ${p.price || 'No disponible'}`;
                            openProductModal();
                        });

                        container.appendChild(div);
                    });
                }

                
                async function fetchAllProducts(){
                    try{
                        const res = await fetch('/api/products');
                        if (!res.ok) throw new Error('Error al obtener productos');
                        allProducts = await res.json();
                        renderProducts(allProducts);
                    }catch(e){
                        console.error(e);
                        container.innerHTML = '';
                    }
                }

                function showCategory(cat){
                    const titleEl = document.getElementById('category-title');
                    if (!cat || cat === 'All') { 
                        renderProducts(allProducts);
                        if (titleEl) titleEl.style.display = 'none';
                        return; 
                    }
                    
                    // Mostrar el t√≠tulo de la categor√≠a
                    if (titleEl) {
                        titleEl.textContent = cat.toUpperCase();
                        titleEl.style.display = 'block';
                    }
                    
                    const filtered = allProducts.filter(p => String(p.category).toLowerCase() === String(cat).toLowerCase());
                    renderProducts(filtered);
                }

                
                function initNavFilters(){
                    if (!nav) return;
                    const links = Array.from(nav.querySelectorAll('a[data-category]'));
                    
                    function toggleFeaturedColumns(show){
                        const cols = document.querySelectorAll('.featured-products .section-column');
                        cols.forEach(c => {
                            c.style.display = show ? '' : 'none';
                        });
                    }

                        
                        
                        function hideInfoSections(){
                            const aboutEl = document.getElementById('about');
                            const contactEl = document.getElementById('contacto');
                            const metodosEl = document.getElementById('metodos');
                            if (aboutEl) aboutEl.style.display = 'none';
                            if (contactEl) contactEl.style.display = 'none';
                            if (metodosEl) metodosEl.style.display = 'none';
                        }
                        function showOnlySection(id){
                            hideInfoSections();
                            const el = document.getElementById(id);
                            if (el) { el.style.display = 'block'; el.scrollIntoView({behavior:'smooth'}); }
                        }

                        // Helper to show/hide hero and keep footer location stable
                        function toggleHero(show){
                            const heroEl = document.querySelector('.hero');
                            const mainEl = document.querySelector('main');
                            const headerEl = document.querySelector('.main-header');
                            const navEl = document.querySelector('.main-nav');
                            const footerEl = document.querySelector('.main-footer');
                            if (!heroEl || !mainEl) return;
                            if (show) {
                                heroEl.style.display = '';
                                mainEl.style.minHeight = '';
                            } else {
                                heroEl.style.display = 'none';
                                const headerH = headerEl ? headerEl.getBoundingClientRect().height : 0;
                                const navH = navEl ? navEl.getBoundingClientRect().height : 0;
                                const footerH = footerEl ? footerEl.getBoundingClientRect().height : 0;
                                const space = Math.max(220, window.innerHeight - headerH - navH - footerH);
                                mainEl.style.minHeight = space + 'px';
                            }
                        }

                    
                    function setHomeMode(show){
                        window.isHomeMode = !!show;
                        const cols = document.querySelectorAll('.featured-products .section-column');
                        cols.forEach(c => c.style.display = show ? '' : 'none');
                    }

                    links.forEach(a => {
                        a.addEventListener('click', (e)=>{
                            e.preventDefault();
                            const cat = a.dataset.category;

                            links.forEach(x=>x.classList.remove('active'));
                            a.classList.add('active');

                            const titleEl = document.getElementById('category-title');
                            if (titleEl) {
                                titleEl.textContent = a.textContent.trim();
                                titleEl.style.display = '';
                            }

                            
                            if (cat === 'Home') {
                                hideInfoSections();
                                toggleHero(true);
                                showHome();
                                // do not call showProducts() here: products must only appear when a category is selected
                                return;
                            }
                            if (cat === 'About') {
                                
                                setHomeMode(false);
                                toggleHero(false);
                                showOnlySection('about');
                                hideProducts();
                                return;
                            }
                            if (cat === 'Contact') {
                                setHomeMode(false);
                                toggleHero(false);
                                showOnlySection('contacto');
                                hideProducts();
                                return;
                            }

                            
                            hideInfoSections();
                            setHomeMode(false);
                            toggleHero(false);
                            showCategory(cat);
                            showProducts();
                        });
                    });

                    
                    const sideNav = document.getElementById('side-nav');
                    if (sideNav){
                        sideNav.innerHTML = '';
                        const items = [
                            { text: 'INICIO', action: () => { if (typeof showHome === 'function') { showHome(); } if (typeof showProducts === 'function') showProducts(); } },
                            { text: 'QUIENES SOMOS', action: () => { if (typeof setHomeMode === 'function') setHomeMode(false); if (typeof toggleHero === 'function') toggleHero(false); if (typeof showOnlySection === 'function') showOnlySection('about'); if (typeof hideProducts === 'function') hideProducts(); } },
                            { text: 'CONTACTANOS', action: () => { if (typeof setHomeMode === 'function') setHomeMode(false); if (typeof toggleHero === 'function') toggleHero(false); if (typeof showOnlySection === 'function') showOnlySection('contacto'); if (typeof hideProducts === 'function') hideProducts(); } },
                            { text: 'MEDIOS DE PAGO', action: () => { if (typeof setHomeMode === 'function') setHomeMode(false); if (typeof toggleHero === 'function') toggleHero(false); if (typeof showOnlySection === 'function') showOnlySection('metodos'); if (typeof hideProducts === 'function') hideProducts(); } },
                            { text: 'POL√çTICA DE PRIVACIDAD', action: () => { const footer = document.querySelector('.main-footer'); if (footer) footer.scrollIntoView({behavior:'smooth'}); } },
                            { text: 'FAQ', action: () => { const footer = document.querySelector('.main-footer'); if (footer) footer.scrollIntoView({behavior:'smooth'}); } }
                        ];

                        items.forEach(it => {
                            const btn = document.createElement('button');
                            btn.type = 'button';
                            btn.className = 'side-link';
                            btn.textContent = it.text;
                            btn.addEventListener('click', ()=>{
                                try { it.action(); } catch(e){ console.error(e); }
                                const side = document.getElementById('side-panel');
                                const overlay = document.getElementById('side-overlay');
                                if (side) side.classList.remove('open');
                                if (side) side.setAttribute('aria-hidden','true');
                                if (overlay) overlay.classList.remove('open');
                            });
                            sideNav.appendChild(btn);
                        });
                    }
                }

                  
                document.addEventListener('DOMContentLoaded', ()=>{
                    initNavFilters();
                    
                    fetchAllProducts().then(()=>{
                        initSearchBar();
                       
                        const titleEl = document.getElementById('category-title');
                        if (titleEl) { titleEl.style.display = 'none'; titleEl.textContent = ''; }
                      
                        // Do not show products on Inicio by default. Products appear when a category is clicked.
                        window.isHomeMode = false;
                        if (typeof hideProducts === 'function') hideProducts();
                        const colsInit = document.querySelectorAll('.featured-products .section-column');
                        colsInit.forEach(c => c.style.display = '');
                    });
                });

                    
                    function showHome(){
                        // Home should not display the product carousel. Keep featured columns visible.
                        window.isHomeMode = false;
                        const cols = document.querySelectorAll('.featured-products .section-column');
                        cols.forEach(c => c.style.display = '');

                        document.querySelectorAll('#nav-links a').forEach(a=>a.classList.remove('active'));
                        document.querySelectorAll('#side-nav .side-link').forEach(b=>b.classList.remove('active'));
                      
                        const titleEl = document.getElementById('category-title'); if (titleEl) { titleEl.style.display = 'none'; titleEl.textContent = ''; }
                       
                        // Ensure products are hidden on Home
                        if (typeof hideProducts === 'function') hideProducts();
                    }

                    
                    document.addEventListener('DOMContentLoaded', ()=>{
                        const hb = document.getElementById('home-btn');
                        if (hb) hb.addEventListener('click', (e)=>{ e.preventDefault(); showHome(); });
                        
                        const sideNav = document.getElementById('side-nav');
                        if (sideNav){
                            const btn = document.createElement('button');
                            btn.type = 'button'; btn.className = 'side-link'; btn.textContent = 'INICIO';
                            btn.addEventListener('click', ()=>{ showHome(); const side = document.getElementById('side-panel'); const overlay = document.getElementById('side-overlay'); if (side) side.classList.remove('open'); if (overlay) overlay.classList.remove('open'); });
                            sideNav.insertBefore(btn, sideNav.firstChild);
                        }
                       
                        
                    });
            })();
        </script>

    <script>
        
        (function(){
            const toggle = document.getElementById('nav-toggle');
            const side = document.getElementById('side-panel');
            const closeBtn = document.getElementById('side-close');
            const overlay = document.getElementById('side-overlay');
            if (!toggle || !side) return;

            function setOpen(val){
                
                if (val && window.matchMedia('(max-width:600px)').matches) {
                    
                    toggle.setAttribute('aria-expanded', 'false');
                    return;
                }

                toggle.setAttribute('aria-expanded', String(val));
                if (val) {
                    side.classList.add('open');
                    side.setAttribute('aria-hidden','false');
                    if (overlay) overlay.classList.add('open');
                } else {
                    side.classList.remove('open');
                    side.setAttribute('aria-hidden','true');
                    if (overlay) overlay.classList.remove('open');
                }
            }

            toggle.addEventListener('click', ()=>{
                const expanded = toggle.getAttribute('aria-expanded') === 'true';
                setOpen(!expanded);
                const navLinks = document.getElementById('nav-links');
                if (navLinks) navLinks.classList.toggle('open');
            });

            if (closeBtn) closeBtn.addEventListener('click', ()=> setOpen(false));
            if (overlay) overlay.addEventListener('click', ()=> setOpen(false));

           
            document.addEventListener('keydown', (e)=>{ if (e.key === 'Escape') setOpen(false); });
        })();
    </script>

        <script>
        
        (function(){
            
        })();

        
        (function(){
            
        })();
        
        
        
    </script>

    <script>
        (function(){
            
            const hero = document.querySelector('.hero');
            const header = document.querySelector('.main-header');
            const nav = document.querySelector('.main-nav');
            const footer = document.querySelector('.main-footer');

            function setHeroHeight(){
                if (!hero) return;
                const headerH = header ? header.getBoundingClientRect().height : 0;
                const navH = nav ? nav.getBoundingClientRect().height : 0;
                const footerH = footer ? footer.getBoundingClientRect().height : 0;
                const available = Math.max(220, window.innerHeight - headerH - navH - footerH);
                hero.style.minHeight = available + 'px';
                
                const mainEl = document.querySelector('main');
                if (mainEl) {
                    if (hero.style.display === 'none') mainEl.style.minHeight = available + 'px';
                    else mainEl.style.minHeight = '';
                }
            }

            window.addEventListener('resize', setHeroHeight);
            window.addEventListener('load', setHeroHeight);
            document.addEventListener('DOMContentLoaded', setHeroHeight);

            
            const obs = new MutationObserver(setHeroHeight);
            if (header) obs.observe(header, { attributes: true, childList: true, subtree: true });
            if (nav) obs.observe(nav, { attributes: true, childList: true, subtree: true });
            if (footer) obs.observe(footer, { attributes: true, childList: true, subtree: true });
        })();
    </script>

    <script>
    (function(){
        const el = document.getElementById('footer-copy');
        if (!el) return;
        function updateCopy(){
            const year = new Date().getFullYear();
            if (window.matchMedia('(max-width:600px)').matches){
                el.textContent = `¬© ${year} Supermercado Las Cuatro Milpas.`;
            } else {
                el.textContent = `¬© ${year} Supermercado Las Cuatro Milpas. Todos los derechos reservados.`;
            }
        }
        updateCopy();
        
        window.addEventListener('resize', updateCopy);
        const mq = window.matchMedia('(max-width:600px)');
        if (mq.addEventListener) mq.addEventListener('change', updateCopy);
        else if (mq.addListener) mq.addListener(updateCopy);
    })();
    </script>

    <script>
    
    (function(){
        function cleanContainer(container){
            Array.from(container.childNodes).forEach(node => {
                if (node.nodeType === Node.TEXT_NODE) {
                    if ((node.textContent || '').trim() === '+' || (node.textContent || '').trim() === '‚úö') {
                        node.parentNode.removeChild(node);
                    }
                }
                if (node.nodeType === Node.ELEMENT_NODE) {
                    const txt = (node.textContent || '').trim();
                    if (txt === '+' || txt === '‚úö') node.remove();
                }
            });
            container.querySelectorAll('.plus, .decor, .decorative, .cross').forEach(el=>el.remove());
        }

        document.addEventListener('DOMContentLoaded', ()=>{
            const containers = document.querySelectorAll('.contact-social .social-icons');
            containers.forEach(container => {
                cleanContainer(container);

                
                const mo = new MutationObserver(muts => {
                    muts.forEach(m => {
                        m.addedNodes && m.addedNodes.forEach(n => {
                            try { if (n.nodeType === Node.TEXT_NODE && (n.textContent||'').trim() === '+') n.parentNode.removeChild(n); }
                            catch(e){}
                            try { if (n.nodeType === Node.ELEMENT_NODE) cleanContainer(container); }
                            catch(e){}
                        });
                    });
                });
                mo.observe(container, { childList: true, subtree: true });
            });
        });
    })();
    </script>

    <!-- Product detail modal (styled like reference) -->
    <div class="product-detail" id="product-detail" aria-hidden="true">
        <div class="pd-overlay"></div>
        <div class="pd-panel" role="dialog" aria-modal="true">
            <button class="pd-close" aria-label="Cerrar">&times;</button>
            <div class="pd-content">
                <div class="pd-image"><img id="modal-image" src="" alt=""></div>
                <div class="pd-info">
                    <h2 id="modal-title"></h2>
                    <div class="muted" id="modal-category"></div>
                    <p id="modal-description"></p>
                    <div class="pd-pricebox" aria-hidden="false">
                        <div class="label">Precio</div>
                        <div class="price" id="modal-price">$0</div>
                        <div class="sub" id="modal-sub"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal open/close helpers
        function openProductModal(){
            const el = document.getElementById('product-detail');
            if (!el) return; el.classList.add('open'); el.setAttribute('aria-hidden','false');
        }
        function closeProductModal(){
            const el = document.getElementById('product-detail');
            if (!el) return; el.classList.remove('open'); el.setAttribute('aria-hidden','true');
        }
        document.addEventListener('click', (e)=>{
            if (e.target && e.target.classList && e.target.classList.contains('pd-close')) closeProductModal();
            if (e.target && e.target.classList && e.target.classList.contains('pd-overlay')) closeProductModal();
        });
    </script>

</body>
</html>
